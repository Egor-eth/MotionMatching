#version 440
#define PS 1


#define USE_UV

struct Material
{
  #define LAMBERT

  float sectionScale;
};









out vec4 FragColor;

uniform sampler2D mainTex;

void main()
{
  float toCameraDist = length(CameraPosition - vsOutput.WorldPosition);
  vec2 section = vsOutput.WorldPosition.xz / material_inst.sectionScale;
  section = fract(section);
  section = min(section, abs(section - vec2(1,1)));
  float t = min(section.x, section.y);
  bool addSection = toCameraDist < 45 && t * material_inst.sectionScale < 0.05;
  vec3 texColor = addSection ? vec3(1, 1, 1) : texture(mainTex, vsOutput.UV).rgb;
  vec3 color = LightedColor(texColor, material_inst, vsOutput, LightDirection, CameraPosition);
  FragColor = vec4(color, 1.0);
}